# BikeController API 功能测试表格

## API 概述
BikeController 提供了自行车管理相关的 API，包括查看自行车、添加自行车、更新自行车信息以及删除自行车等功能。

## 功能测试表格

| 序号 | API 接口 | HTTP 方法 | URL 路径 | 请求参数 | 预期响应 | 测试场景 | 测试步骤 | 预期结果 |
|------|---------|----------|---------|---------|---------|---------|---------|---------|
| 1 | 查看自行车 | GET | /bike | 无请求体，需要在请求头中包含有效的JWT令牌 | 返回当前用户拥有的自行车列表 | 1.1 有效令牌 | 1. 使用有效的JWT令牌发送请求<br>2. 检查响应状态码和内容 | 状态码：200 OK<br>响应体：包含用户拥有的自行车列表的JSON数组 |
| 2 | 查看自行车 | GET | /bike | 无请求体，请求头中包含无效的JWT令牌 | 返回未授权错误 | 1.2 无效令牌 | 1. 使用无效的JWT令牌发送请求<br>2. 检查响应状态码和内容 | 状态码：401 Unauthorized<br>响应体：错误信息 |
| 3 | 查看自行车 | GET | /bike | 无请求体，请求头中不包含JWT令牌 | 返回未授权错误 | 1.3 无令牌 | 1. 不带JWT令牌发送请求<br>2. 检查响应状态码和内容 | 状态码：401 Unauthorized<br>响应体：错误信息 |
| 4 | 添加自行车 | POST | /bike/add | 包含自行车信息的JSON对象，如：<br>```{"bikename": "测试车辆", "type": "private", "status": 0}``` | 返回添加结果 | 2.1 有效的自行车信息 | 1. 使用有效的JWT令牌发送包含有效自行车信息的请求<br>2. 检查响应状态码和内容 | 状态码：200 OK<br>响应体："添加成功, bikeId: [id]" |
| 5 | 添加自行车 | POST | /bike/add | 缺少必要字段的JSON对象 | 返回错误 | 2.2 缺少必要字段 | 1. 使用有效的JWT令牌发送缺少必要字段的请求<br>2. 检查响应状态码和内容 | 状态码：400 Bad Request<br>响应体：错误信息 |
| 6 | 添加自行车 | POST | /bike/add | 包含无效字段值的JSON对象 | 返回错误 | 2.3 无效字段值 | 1. 使用有效的JWT令牌发送包含无效字段值的请求<br>2. 检查响应状态码和内容 | 状态码：400 Bad Request<br>响应体："添加失败." |
| 7 | 更新自行车 | PUT | /bike/update | 包含自行车信息的JSON对象，如：<br>```{"bikeid": 1, "bikename": "新名称", "type": "share", "status": 1}``` | 返回更新后的自行车信息 | 3.1 有效的自行车信息且属于当前用户 | 1. 使用有效的JWT令牌发送包含有效自行车信息的请求<br>2. 检查响应状态码和内容 | 状态码：200 OK<br>响应体：更新后的自行车信息JSON对象 |
| 8 | 更新自行车 | PUT | /bike/update | 包含不属于当前用户的自行车ID的JSON对象 | 返回错误 | 3.2 自行车不属于当前用户 | 1. 使用有效的JWT令牌发送包含不属于当前用户的自行车ID的请求<br>2. 检查响应状态码和内容 | 状态码：400 Bad Request<br>响应体："更新失败, 车辆不属于您." |
| 9 | 更新自行车 | PUT | /bike/update | 包含不存在的自行车ID的JSON对象 | 返回错误 | 3.3 不存在的自行车ID | 1. 使用有效的JWT令牌发送包含不存在的自行车ID的请求<br>2. 检查响应状态码和内容 | 状态码：400 Bad Request 或 500 Internal Server Error<br>响应体：错误信息 |
| 10 | 更新自行车 | PUT | /bike/update | 包含类型从"private"变为"share"的自行车信息 | 返回更新后的自行车信息，并更新相关停车位状态 | 3.4 更改自行车类型为共享 | 1. 使用有效的JWT令牌发送包含类型从"private"变为"share"的自行车信息<br>2. 检查响应状态码和内容<br>3. 检查相关停车位状态是否更新 | 状态码：200 OK<br>响应体：更新后的自行车信息JSON对象<br>停车位状态应更新为2 |
| 11 | 更新自行车 | PUT | /bike/update | 包含类型从"share"变为"private"的自行车信息 | 返回更新后的自行车信息，并更新相关停车位状态 | 3.5 更改自行车类型为私有 | 1. 使用有效的JWT令牌发送包含类型从"share"变为"private"的自行车信息<br>2. 检查响应状态码和内容<br>3. 检查相关停车位状态是否更新 | 状态码：200 OK<br>响应体：更新后的自行车信息JSON对象<br>停车位状态应更新为1 |
| 12 | 删除自行车 | DELETE | /bike/delete | 请求参数：id=1（属于当前用户的自行车ID） | 返回删除结果 | 4.1 有效的自行车ID且属于当前用户 | 1. 使用有效的JWT令牌发送包含有效自行车ID的请求<br>2. 检查响应状态码和内容 | 状态码：200 OK<br>响应体："删除成功." |
| 13 | 删除自行车 | DELETE | /bike/delete | 请求参数：id=2（不属于当前用户的自行车ID） | 返回错误 | 4.2 自行车不属于当前用户 | 1. 使用有效的JWT令牌发送包含不属于当前用户的自行车ID的请求<br>2. 检查响应状态码和内容 | 状态码：400 Bad Request<br>响应体："删除失败, 车辆不属于您." |
| 14 | 删除自行车 | DELETE | /bike/delete | 请求参数：id=999（不存在的自行车ID） | 返回错误 | 4.3 不存在的自行车ID | 1. 使用有效的JWT令牌发送包含不存在的自行车ID的请求<br>2. 检查响应状态码和内容 | 状态码：400 Bad Request 或 500 Internal Server Error<br>响应体：错误信息 |

## 测试注意事项

1. **认证要求**：所有接口都需要JWT令牌认证
2. **数据准备**：测试前需要准备测试数据，包括用户账号、自行车信息等
3. **测试顺序**：建议按照添加 -> 查询 -> 更新 -> 删除的顺序进行测试
4. **边界测试**：应测试各种边界情况，如空值、特殊字符、超长字符串等
5. **安全测试**：应测试未授权访问、越权操作等安全问题
6. **关联测试**：自行车类型变更会影响停车位状态，需要测试这种关联关系
7. **并发测试**：可测试多用户同时操作的情况

## 测试环境要求

1. 后端服务已正确部署并运行
2. 数据库已正确配置并包含必要的表结构
3. 测试工具（如Postman、JMeter等）已准备就绪
4. 已创建测试用户并获取有效的JWT令牌